<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title }} - {{ site.title }}</title>
  <link rel="stylesheet" href="{{ '/assets/style.css' | relative_url }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
  <header>
    <nav class="navbar">
      <div class="navbar-logo">
        <a href="{{ site.baseurl }}/" class="navbar-brand">
          <img src="{{ site.baseurl }}/assets/images/logo.png" alt="Señor Torres Logo">
          <span>Señor Torres Blog</span>
        </a>
      </div>
      <button class="navbar-toggle" aria-label="Toggle navigation">
        <span class="navbar-toggle-icon"></span>
      </button>
      <ul class="navbar-menu">
        <li class="navbar-item"><a href="{{ site.baseurl }}/" class="navbar-link">Inicio</a></li>
        <li class="navbar-item"><a href="{{ site.baseurl }}/about/" class="navbar-link">Quién soy</a></li>
        <li class="navbar-item"><a href="{{ site.baseurl }}/blog/" class="navbar-link">Blog</a></li>
        <li class="navbar-item"><a href="{{ site.baseurl }}/contact/" class="navbar-link">Contacto</a></li>
      </ul>
              <!-- Contenedor para la onda -->
              <div class="wave-right">
                <svg width="100%" height="100%" id="svg" viewBox="0 0 1440 200" xmlns="http://www.w3.org/2000/svg" class="transition duration-300 ease-in-out delay-150">
                  <style>
                    .path-0 {
                      animation: pathAnim-0 4s;
                      animation-timing-function: linear;
                      animation-iteration-count: infinite;
                    }
                    @keyframes pathAnim-0 {
                      0% {
                        d: path("M 0,200 L 0,70 C 165,65 330,60 495,65 C 660,70 825,85 990,85 C 1155,85 1320,70 1440,65 L 1440,200 L 0,200 Z");
                      }
                      33% {
                        d: path("M 0,200 L 0,75 C 165,80 330,85 495,75 C 660,65 825,40 990,35 C 1155,30 1320,45 1440,50 L 1440,200 L 0,200 Z");
                      }
                      66% {
                        d: path("M 0,200 L 0,65 C 165,75 330,85 495,80 C 660,75 825,55 990,50 C 1155,45 1320,55 1440,60 L 1440,200 L 0,200 Z");
                      }
                      100% {
                        d: path("M 0,200 L 0,70 C 165,65 330,60 495,65 C 660,70 825,85 990,85 C 1155,85 1320,70 1440,65 L 1440,200 L 0,200 Z");
                      }
                    }
                  </style>
                  <path d="M 0,200 L 0,70 C 165,65 330,60 495,65 C 660,70 825,85 990,85 C 1155,85 1320,70 1440,65 L 1440,200 L 0,200 Z" stroke="none" stroke-width="0" fill="#0693e3" fill-opacity="0.53" class="transition-all duration-300 ease-in-out delay-150 path-0"></path>
                  
                  <style>
                    .path-1 {
                      animation: pathAnim-1 4s;
                      animation-timing-function: linear;
                      animation-iteration-count: infinite;
                    }
                    @keyframes pathAnim-1 {
                      0% {
                        d: path("M 0,200 L 0,130 C 165,135 330,140 495,135 C 660,130 825,115 990,115 C 1155,115 1320,130 1440,135 L 1440,200 L 0,200 Z");
                      }
                      33% {
                        d: path("M 0,200 L 0,125 C 165,120 330,115 495,125 C 660,135 825,160 990,165 C 1155,170 1320,155 1440,150 L 1440,200 L 0,200 Z");
                      }
                      66% {
                        d: path("M 0,200 L 0,135 C 165,125 330,115 495,120 C 660,125 825,145 990,150 C 1155,155 1320,145 1440,140 L 1440,200 L 0,200 Z");
                      }
                      100% {
                        d: path("M 0,200 L 0,130 C 165,135 330,140 495,135 C 660,130 825,115 990,115 C 1155,115 1320,130 1440,135 L 1440,200 L 0,200 Z");
                      }
                    }
                  </style>
                  <path d="M 0,200 L 0,130 C 165,135 330,140 495,135 C 660,130 825,115 990,115 C 1155,115 1320,130 1440,135 L 1440,200 L 0,200 Z" stroke="none" stroke-width="0" fill="#0693e3" fill-opacity="1" class="transition-all duration-300 ease-in-out delay-150 path-1"></path>
                </svg>
              </div>
    </nav>
  </header>

  <main>
    <!-- Menú lateral del blog -->
    <div class="blog-sidebar" id="blogSidebar">
      <div class="sidebar-header">
          <h3 class="sidebar-title">Últimos Posts</h3>
          <button class="toggle-btn" id="toggleBtn">
              <i class="fas fa-chevron-left"></i>
          </button>
      </div>
      
      <div class="blog-posts-list" id="blogPostsList">
          <!-- Los posts se cargarán dinámicamente aquí -->
      </div>
      
      <div class="sidebar-footer">
          <button class="view-all-btn" onclick="viewAllPosts()">
              <i class="fas fa-th-list"></i>
              <span>Ver todos</span>
          </button>
      </div>
  </div>
    <div class="container">
      <article class="post">
        <header class="post-header">
          <h1 class="post-title">{{ page.title }}</h1>
          <div class="post-meta">
            <span class="post-date">
              <i class="far fa-calendar-alt"></i> {{ page.date | date: "%d %b, %Y" }}
            </span>
            {% if page.reading_time %}
            <span class="reading-time">
              <i class="far fa-clock"></i> {{ page.reading_time }} min lectura
            </span>
            {% endif %}
          </div>
        </header>

        <div class="post-content">
          {{ content }}
        </div>

        {% if page.tags %}
        <footer class="post-footer">
          <div class="post-tags">
            <strong>Etiquetas:</strong>
            {% for tag in page.tags %}
            <span class="post-tag">{{ tag }}</span>
            {% endfor %}
          </div>
        </footer>
        {% endif %}
      </article>
  
      <!-- Navegación entre posts -->
  <nav class="post-navigation">
    <div class="nav-links">
      {% if page.previous %}
      <a href="{{ page.previous.url | relative_url }}" class="nav-link prev-post">
        <i class="fas fa-arrow-left"></i> {{ page.previous.title }}
      </a>
      {% endif %}
  
      {% if page.next %}
      <a href="{{ page.next.url | relative_url }}" class="nav-link next-post">
        {{ page.next.title }} <i class="fas fa-arrow-right"></i>
      </a>
      {% endif %}
    </div>
  </nav>
  </main>
</div>
  <footer>
    <div class="container">
      <p>&copy; {{ site.time | date: "%Y" }} {{ site.title }} - Todos los derechos reservados.</p>
    </div>
  </footer>
  <script>
    // Los posts reales se cargarán desde Jekyll
    let blogPosts = [];

    // Función para formatear fecha
    function formatDate(dateString) {
        const date = new Date(dateString);
        const options = { day: 'numeric', month: 'short', year: 'numeric' };
        return date.toLocaleDateString('es-ES', options);
    }

    // Función para cargar posts reales de Jekyll
    function loadJekyllPosts() {
        const postsContainer = document.getElementById('blogPostsList');
        
        // Si no hay posts cargados, mostrar mensaje
        if (blogPosts.length === 0) {
            postsContainer.innerHTML = `
                <div class="blog-post-item" style="text-align: center; opacity: 0.7;">
                    <div class="post-content">
                        <p style="color: white; font-size: 12px; margin: 10px 0;">
                            <i class="fas fa-info-circle"></i><br>
                            No hay posts disponibles
                        </p>
                    </div>
                </div>
            `;
            return;
        }
        
        blogPosts.forEach(post => {
            const postElement = document.createElement('div');
            postElement.className = 'blog-post-item';
            postElement.onclick = () => navigateToPost(post.url);
            
            postElement.innerHTML = `
                <i class="post-icon fas fa-file-alt"></i>
                <div class="post-content">
                    <h4 class="post-title">${post.title}</h4>
                    <div class="post-date">
                        <i class="far fa-calendar-alt"></i>
                        ${formatDate(post.date)}
                    </div>
                    <div class="post-tags">
                        ${post.tags && post.tags.length > 0 ? 
                            post.tags.map(tag => `<span class="post-tag">${tag}</span>`).join('') : 
                            '<span class="post-tag">General</span>'
                        }
                    </div>
                </div>
            `;
            
            postsContainer.appendChild(postElement);
        });
    }

    // Función para navegar a un post
    function navigateToPost(url) {
        // Navegar al post real
        window.location.href = url;
    }

    // Función para ver todos los posts
    function viewAllPosts() {
        // Navegar a la página principal del blog
        window.location.href = '{{ site.baseurl }}/blog' || '/blog';
    }

    // Función para toggle del menú lateral
    function toggleSidebar() {
        const sidebar = document.getElementById('blogSidebar');
        const toggleBtn = document.getElementById('toggleBtn');
        const icon = toggleBtn.querySelector('i');
        
        sidebar.classList.toggle('collapsed');
        
        if (sidebar.classList.contains('collapsed')) {
            icon.className = 'fas fa-chevron-right';
        } else {
            icon.className = 'fas fa-chevron-left';
        }
    }

    // Event listeners
    document.addEventListener('DOMContentLoaded', function() {
        loadJekyllPosts();
        
        document.getElementById('toggleBtn').addEventListener('click', toggleSidebar);
        
        // Auto-colapsar en pantallas pequeñas
        if (window.innerWidth <= 768) {
            setTimeout(toggleSidebar, 1000);
        }
    });

    // CÓDIGO PARA INTEGRAR CON JEKYLL - COPIA ESTE BLOQUE COMPLETO
    // =================================================================
    
    // 1. REEMPLAZA LA LÍNEA 'let blogPosts = [];' CON ESTE CÓDIGO:
    /*
    {% assign recent_posts = site.posts | limit: 6 %}
    const blogPosts = [
        {% for post in recent_posts %}
        {
            title: `{{ post.title | escape | strip_newlines }}`,
            date: "{{ post.date | date: '%Y-%m-%d' }}",
            tags: [{% for tag in post.tags %}"{{ tag | escape }}"{% unless forloop.last %},{% endunless %}{% endfor %}],
            url: "{{ site.baseurl }}{{ post.url }}",
            excerpt: `{{ post.excerpt | strip_html | truncate: 100 | escape }}`
        }{% unless forloop.last %},{% endunless %}
        {% endfor %}
    ];
    */
    
    // 2. O TAMBIÉN PUEDES USAR ESTA VERSIÓN MÁS ROBUSTA:
    /*
    <script>
        // Cargar posts dinámicamente desde Jekyll
        window.addEventListener('DOMContentLoaded', function() {
            // Posts inyectados por Jekyll
            {% assign recent_posts = site.posts | limit: 8 %}
            const jekyllPosts = [
                {% for post in recent_posts %}
                {
                    title: {{ post.title | jsonify }},
                    date: "{{ post.date | date: '%Y-%m-%d' }}",
                    tags: {{ post.tags | jsonify }},
                    url: "{{ site.baseurl }}{{ post.url }}",
                    excerpt: {{ post.excerpt | strip_html | truncate: 80 | jsonify }},
                    author: "{{ post.author | default: site.author | default: 'Wilder Andres Quinto T.' }}",
                    reading_time: "{{ post.reading_time | default: '5 min' }}"
                }{% unless forloop.last %},{% endunless %}
                {% endfor %}
            ];
            
            // Asignar posts y cargar el menú
            blogPosts = jekyllPosts;
            loadJekyllPosts();
        }); */
    </script>
</body>
</html>